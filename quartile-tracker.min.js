//! Quartile Tracker, http://tpkn.me/
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QuartileTracker(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(e instanceof Element))throw new TypeError("Expected a DOM element");if("object"!==_typeof(t))throw new TypeError("Expected an Object");var o=r.auto_reset,n=void 0===o?1:o,a=r.verbose,i=void 0===a?0:a,c=0,l=0,s=e.loop;s&&(e.loop=0);for(var f=[],p=0,u=t.length;p<u;p++){var d=Object.assign({},t[p]);if(!d.hasOwnProperty("time"))throw new Error("[QT] tracker #"+(p+1)+" does not have the 'time' property set!");if(!d.hasOwnProperty("pixel")&&!d.hasOwnProperty("callback"))throw new Error("[QT] tracker #"+(p+1)+" does not have neither 'pixel' nor 'callback' property set!");var y=d.time,v=d.pixel,m=d.callback,h=parseFloat(y);if(isNaN(h)||h<0)throw new Error("[QT] tracker #"+(p+1)+" has invalid time format: unparsable number or it's less than 0!");"string"==typeof y&&y.indexOf("%")===y.length-1&&(d.in_percent=1),"string"==typeof v&&(d.has_pixel=1),"function"==typeof m&&(d.has_callback=1),d.time=h,f.push(d)}function b(){c=e.duration,l=e.currentTime;for(var t=0,r=f.length;t<r;t++){var o=f[t];if(0!=o.active){var n=o.time,a=o.in_percent,i=o.has_pixel,s=o.pixel,p=o.has_callback,u=o.callback;(1==a&&c>0?l/c*100:l)>=n&&(1==i&&w(s),1==p&&u(),o.active=0,x("tracker ("+n+(a?"%":"sec")+"):",s))}}}function k(){n&&E(),s&&e.play()}function w(e){var t=new Image;t.src=e,t.onload=t.onerror=function(){t=null}}function E(){for(var e=0,t=f.length;e<t;e++)f[e].active=1;x("all trackers are reset")}function T(){e.removeEventListener("timeupdate",b),e.removeEventListener("ended",k),x("destroyed")}function x(){i&&console.log("[QT]",Object.values(arguments).join(" "))}return e.addEventListener("timeupdate",b),e.addEventListener("ended",k),{reset:E,destroy:T}}"undefined"!=typeof module&&void 0!==module.exports?module.exports=QuartileTracker:"function"==typeof define&&define.amd?define([],(function(){return QuartileTracker})):window.QuartileTracker=QuartileTracker;